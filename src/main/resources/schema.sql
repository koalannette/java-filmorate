DROP TABLE IF EXISTS films cascade ;
DROP TABLE IF EXISTS film_genre cascade;
DROP TABLE IF EXISTS genre cascade;
DROP TABLE IF EXISTS likes cascade;
DROP TABLE IF EXISTS mpa cascade;
DROP TABLE IF EXISTS users cascade;
DROP TABLE IF EXISTS friends cascade;

CREATE TABLE IF NOT EXISTS users (
id BIGINT AUTO_INCREMENT PRIMARY KEY,
email VARCHAR(100) NOT NULL,
login VARCHAR(100) NOT NULL,
name VARCHAR(100),
birthday DATE
);

CREATE TABLE IF NOT EXISTS friends (
user_id BIGINT REFERENCES users(id),
friend_id BIGINT REFERENCES users(id),
status boolean,
CONSTRAINT uq_friendship UNIQUE (user_id,friend_id)
);

CREATE TABLE IF NOT EXISTS mpa (
mpa_id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
name varchar(100) NOT NULL,
description varchar(200)
);

CREATE TABLE IF NOT EXISTS films (
id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
name VARCHAR(100) NOT NULL,
description VARCHAR(200),
release_date DATE,
duration INTEGER,
mpa_id INTEGER REFERENCES mpa(mpa_id)
);

CREATE TABLE IF NOT EXISTS likes (
film_id BIGINT REFERENCES films(id),
user_id BIGINT REFERENCES users(id)
);

CREATE TABLE IF NOT EXISTS genre (
id INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
name VARCHAR(100)
);

CREATE TABLE IF NOT EXISTS film_genre (
film_id BIGINT REFERENCES films(id),
genre_id INTEGER REFERENCES genre(id)
);










